#include "iobus_crc.h"

unsigned short crc_ta[256]={0xf078,0xe1f1,0xd36a,0xc2e3,0xb65c,0xa7d5,
0x954e,0x84c7,0x7c30,0x6db9,0x5f22,0x4eab,0x3a14,0x2b9d,0x1906,0x088f,
0xe0f9,0xf170,0xc3eb,0xd262,0xa6dd,0xb754,0x85cf,0x9446,0x6cb1,0x7d38,
0x4fa3,0x5e2a,0x2a95,0x3b1c,0x0987,0x180e,0xd17a,0xc0f3,0xf268,0xe3e1,
0x975e,0x86d7,0xb44c,0xa5c5,0x5d32,0x4cbb,0x7e20,0x6fa9,0x1b16,0x0a9f,
0x3804,0x298d,0xc1fb,0xd072,0xe2e9,0xf360,0x87df,0x9656,0xa4cd,0xb544,
0x4db3,0x5c3a,0x6ea1,0x7f28,0x0b97,0x1a1e,0x2885,0x390c,0xb27c,0xa3f5,
0x916e,0x80e7,0xf458,0xe5d1,0xd74a,0xc6c3,0x3e34,0x2fbd,0x1d26,0x0caf,
0x7810,0x6999,0x5b02,0x4a8b,0xa2fd,0xb374,0x81ef,0x9066,0xe4d9,0xf550,
0xc7cb,0xd642,0x2eb5,0x3f3c,0x0da7,0x1c2e,0x6891,0x7918,0x4b83,0x5a0a,
0x937e,0x82f7,0xb06c,0xa1e5,0xd55a,0xc4d3,0xf648,0xe7c1,0x1f36,0x0ebf,
0x3c24,0x2dad,0x5912,0x489b,0x7a00,0x6b89,0x83ff,0x9276,0xa0ed,0xb164,
0xc5db,0xd452,0xe6c9,0xf740,0x0fb7,0x1e3e,0x2ca5,0x3d2c,0x4993,0x581a,
0x6a81,0x7b08,0x7470,0x65f9,0x5762,0x46eb,0x3254,0x23dd,0x1146,0x00cf,
0xf838,0xe9b1,0xdb2a,0xcaa3,0xbe1c,0xaf95,0x9d0e,0x8c87,0x64f1,0x7578,
0x47e3,0x566a,0x22d5,0x335c,0x01c7,0x104e,0xe8b9,0xf930,0xcbab,0xda22,
0xae9d,0xbf14,0x8d8f,0x9c06,0x5572,0x44fb,0x7660,0x67e9,0x1356,0x02df,
0x3044,0x21cd,0xd93a,0xc8b3,0xfa28,0xeba1,0x9f1e,0x8e97,0xbc0c,0xad85,
0x45f3,0x547a,0x66e1,0x7768,0x03d7,0x125e,0x20c5,0x314c,0xc9bb,0xd832,
0xeaa9,0xfb20,0x8f9f,0x9e16,0xac8d,0xbd04,0x3674,0x27fd,0x1566,0x04ef,
0x7050,0x61d9,0x5342,0x42cb,0xba3c,0xabb5,0x992e,0x88a7,0xfc18,0xed91,
0xdf0a,0xce83,0x26f5,0x377c,0x05e7,0x146e,0x60d1,0x7158,0x43c3,0x524a,
0xaabd,0xbb34,0x89af,0x9826,0xec99,0xfd10,0xcf8b,0xde02,0x1776,0x06ff,
0x3464,0x25ed,0x5152,0x40db,0x7240,0x63c9,0x9b3e,0x8ab7,0xb82c,0xa9a5,
0xdd1a,0xcc93,0xfe08,0xef81,0x07f7,0x167e,0x24e5,0x356c,0x41d3,0x505a,
0x62c1,0x7348,0x8bbf,0x9a36,0xa8ad,0xb924,0xcd9b,0xdc12,0xee89,0xff00};


unsigned short crc_calc(unsigned char *data,unsigned short count)
{
	unsigned short crc_res = 0x0000;
	unsigned short len = 0x00;
	for (len=0;len<count;len++)
    {
		crc_res = (crc_res >> 8) ^ crc_ta[(crc_res ^ data[len]) & 0xff];
    }
	return crc_res;
}

